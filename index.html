<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script>
  // Dark-mode page already defined in your <style> above

  // Fetch and render index.md
  fetch('index.md')
    .then(r => {
      if (!r.ok) throw new Error('Failed to load index.md');
      return r.text();
    })
    .then(md => {
      const app = document.getElementById('app');
      app.innerHTML = marked.parse(md);

      // Open non-anchor links in a new tab (post-process, no renderer override)
      app.querySelectorAll('a[href]').forEach(a => {
        const href = a.getAttribute('href') || '';
        if (!href.startsWith('#')) {
          a.target = '_blank';
          a.rel = 'noopener noreferrer';
        }
      });
    })
    .catch(err => {
      document.getElementById('app').innerHTML =
        `<p style="color:#f88">Error: ${err.message}</p>
         <p>You can still view the raw markdown <a href="index.md">here</a>.</p>`;
    });
</script>
